"use strict";function eventElement(n){return"<table class='eventTable'><tr><td class='eventTitleTD'>"+("<a href='#' class='gmEvent' data-id='"+n._id+"'>"+n.title+"<\/a><\/td><td class='eventDeleteTD'><a title='Delete event' href='#' data-title='"+n.title+"' data-id='"+n._id+"' class='eventDeleteButton'>x<\/a><\/td><\/tr>")}function mapEvents(n){for(var i,f,r=[],u=getUserID(),t=0;t<n.length;t++)(i="gmEvent",n[t].UserID!=u&&(i="gmEventDisabled"),n[t].Visibility!=2||n[t].UserID==u)&&(f={id:n[t].CalendarID,title:n[t].Venue,allDay:!0,start:cDate(n[t].StartTime),end:cDate(n[t].EndTime),url:n[t].URL,className:i,editable:!0},r.push(f));return r}function cDate(n){var n;return n}function clearEditor(){$("#eventDate").val("");$("#Venue").val("");$("#setupTime").val("12:00am");$("#startTime").val("12:00am");$("#endTime").val("12:00am");$("#sets").val("1");$("#URL").val("");$("#notes").text("");$("#description").text("");$("input:radio[value=0]").prop("checked",!0)}function checkForOwnership(n,t){n!=t?($("#eventDate").prop("disabled",!0),$("#eventDatePicker").data("role",""),$("#Venue").prop("disabled",!0),$("#setupTime").prop("disabled",!0),$("#startTime").prop("disabled",!0),$("#endTime").prop("disabled",!0),$("#sets").prop("disabled",!0),$("#URL").prop("disabled",!0),$("#description").prop("disabled",!0),$("#notes").prop("disabled",!0),$("input:radio[name='vis']").prop("disabled",!0),$("#Submit").hide()):($("#eventDate").prop("disabled",!1),$("#Venue").prop("disabled",!1),$("#setupTime").prop("disabled",!1),$("#startTime").prop("disabled",!1),$("#endTime").prop("disabled",!1),$("#sets").prop("disabled",!1),$("#URL").prop("disabled",!1),$("#notes").prop("disabled",!1),$("#description").prop("disabled",!1),$("input:radio[name='visibility']").prop("disabled",!1),$("#Submit").show())}$(document).ready(function(){var n=JSON.parse(getSession("activeartist")),r=JSON.parse(getSession("loggedinuser")),t,u,f,i;setEventVisibilitySwitch("0");(!n.Artist||n.Artist.PremiumMember)&&(n.Artist||n.PremiumMember)||(window.location.href=document.referrer);$("#colorScheme").prop("checked",getSession("colorscheme")=="highcontrast");$("#eventDate").datepicker();$("#calendar > table").addClass("gm-bg");$(".calendar-dropdown").addClass("gm-bg");$(".calendar-header").addClass("gm-bg");t=calendarList(getUserID(),getActiveArtistID());u=mapEvents(t);$("#setupTime").timepicker();$("#startTime").timepicker();$("#endTime").timepicker();$("#calendar").fullCalendar({header:{right:"basicWeek,basicDay,next",center:"title",left:"prev,today,month"},displyEventTime:!1,selectable:!0,selectHelper:!0,select:function(n){$("#eventDate").val(n.year()+"-"+pad(n.month()+1)+"-"+pad(n.date()));$("#eventDatePicker").data("preset",n.year()+"-"+pad(n.month()+1)+"-"+pad(n.date()));$("#calendarID").val("0");clearEditor();checkForOwnership(getUserID(),getUserID());var t=$("#eventCharm").data("charm");t.element.data("opened")===!0?t.close():t.open();$("#calendar").fullCalendar("unselect")},eventDrop:function(n,t,i){confirm("Move "+n.title+"?")?calendarShift(n._id,t._days):i()},editable:!0,eventLimit:!0,events:u,eventRender:function(n){return eventElement(n)}});$("#closeCharm").click(function(){var n=$("#eventCharm").data("charm");n.element.data("opened")===!0&&n.close()});$("#Submit").click(function(){if($("#Venue").val().trim()==""||$("#eventDate").val()==""){$("#error").text("Event date and Venue are required fields.");return}var n,t,i,r,u,f="",e="",o="",s="",h;n=$("#eventDate").val().split(" ")[0];t=n+" "+$("#startTime").val();i=n+" "+$("#endTime").val();r=n+" "+$("#setupTime").val();u=$("#calendarID").val();f=scrub($("textarea#notes").val());e=scrub($("textarea#description").val());o=scrub($("#URL").val());s=scrub($("#Venue").val());h=$("#EventVisibility").data("evtvisibility");calendarSave(u,getUserID(),getActiveArtistID(),n,s,r,t,i,$("#sets").val(),o,h,f,e).Error?$("#error").text("There was an error saving your event.  Please try again later.  If the problem persists, please contact us."):window.location.reload()});$(document).on("click",".eventDeleteButton",function(){confirm("Delete "+$(this).data("title")+"?")&&(calendarDelete(getUserID(),getActiveArtistID(),$(this).data("id")),$("#calendar").fullCalendar("removeEvents",$(this).data("id")))});$(document).on("click",".gmEvent, .gmEventDisabled",function(n){var u,i,r,f;for(n.preventDefault(),u=$(this).data("id"),i=null,r=0;r<t.length;r++)t[r].CalendarID==u&&(i=t[r]);i&&(checkForOwnership(getUserID(),i.UserID),$("#eventDate").val(i.Date),$("#Venue").val(i.Venue),i.SetupTime&&$("#setupTime").val(i.SetupTime.split(" ")[1]),$("#startTime").val(i.StartTime.split(" ")[1]),$("#endTime").val(i.EndTime.split(" ")[1]),$("#sets").val(i.Sets),$("#URL").val(i.URL),$("#calendarID").val(i.CalendarID),$("#notes").text(i.Notes),$("#description").text(i.Description),setEventVisibilitySwitch(i.Visibility+""),f=$("#eventCharm").data("charm"),f.open())});n.Artist?$("#calendarTitle").text("Calendar for "+n.Artist.ArtistName+"/"+r.Username):$("#calendarTitle").text("Calendar for "+n.ArtistName+"/"+r.Username);f=$(".indexHeader").height()-50;i=document.createElement("style");i.type="text/css";i.innerHTML=".listOffset { margin-top: "+f+"px!important; }";document.getElementsByTagName("head")[0].appendChild(i);$(".indexHeader").height()>55&&$("#calendar").addClass("listOffset")});
/*
//# sourceMappingURL=calendar.min.js.map
*/