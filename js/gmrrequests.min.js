function selected(n){for(var t=1,i,t=1;t<6;t++)if(i=$("#request"+t),i.css("display")!="none"&&i.data("songid")==n)return!0;return!1}function setMessage(n){$("#Message").text(n)}function adjustView(n){var u,i,r,t;if(counts=getCountFromIP(ipAddress,n.ArtistID+""),counts.Songs.length>=n.MaxiRequests&&$("#submitButton").hide(),n.EnableDownvotes||$("a.vote").removeClass("mif-thumbs-up").removeClass("mif-thumbs-down").removeClass("voteLink"),u=0,counts)for(counts.Songs.length>=n.MaxiRequests&&($("#submitButton").addClass("disabled").hide(),$("#Message").text("You have made the maximum number of requests to "+n.ArtistName+" for today."),$(".songLinkA").addClass("disabled"),$(".outerTableWrapper").hide()),t=0;t<counts.Songs.length;t++)i=jlinq.from(sdta).equals("ID",counts.Songs[t].SongID).select()[0],r=addRequest(n,i.ID,i.Title+": "+i.Artist,counts.Songs[t].Weight),$(r).find(".removeRequest").hide(),$(r).find(".vote").addClass("disabled"),$(r).addClass("disabled");for(t=n.MaxiRequests+1-u;t<6;t++)$("#request"+t).hide();n.ShowCategories||songList.column(2).visible(!1);n.ShowArtist||songList.column(1).visible(!1)}function addRequest(n,t,i,r){if(reqID=curRequest&&curRequest!=""?curRequest:getFirstEmptyRequest(),$("#"+reqID).data("songid",t),$("#"+reqID+" .requestText").text(unescape(decodeURI(i))),$("#"+reqID+" .requestText").prop("title",unescape(decodeURI(i))),!n.EnableDownvotes||r){var u=r?r:1;$("#"+reqID).data("vote",u);u>0?($("#"+reqID+" .upVote").addClass("upVoted").addClass("active"),$("#"+reqID+" .downVote").removeClass("upVoted").removeClass("downVoted").addClass("inactive").removeClass("active")):u<0&&($("#"+reqID+" .downVote").addClass("downVoted").addClass("active"),$("#"+reqID+" .upVote").removeClass("downVoted").removeClass("upVoted").addClass("inactive").removeClass("active"))}return"#"+reqID}function getFirstEmptyRequest(){for(var n=1,t,n=1;n<6;n++)if(t=$("#request"+n),t.css("display")!="none"&&!t.hasClass("disabled")&&t.find(".requestText").text().trim()=="")break;return n<=art.MaxiRequests?"request"+n:"request"+art.MaxiRequests}var ipAddress=getClientIP();var art=JSON.parse(getSession("artist")),sdta=songListPublic(art.ArtistID),counts=getCountFromIP(ipAddress,art.ArtistID+""),curRequest="",cs=getSession("gmrcolorscheme");cs||(cs="classic");$("#gmrStyle").prop("href","css/request-"+cs+".min.css");$(document).ready(function(){if(art.iRequestName!="info"){if(art.RequestStatus)$("#helpOpener").show(),$("#reqPanel").show();else{art.OffAirMessage&&art.OffAirMessage.trim()!=""?$(".content").html(art.OffAirMessage):$(".content").html(art.ArtistName+" is offline right now.  You can try their calendar or announcements pages to see whjen they will be back.");$("#reqPanel").hide();$(".frame").addClass("active");return}$(".request").click(function(n){n.stopPropagation();$(".request").removeClass("selectedRequest");curRequest=$(this)[0].id;$(this).toggleClass("selectedRequest")});$(".voteLink").click(function(n){(n.stopPropagation(),$(this).hasClass("disabled"))||($(this).hasClass("upVote")?($(this).parent().parent().removeClass("downVoted"),$(this).removeClass("inactive"),$(this).addClass("active"),$(this).parent().parent().addClass("upVoted"),$(this).closest(".requestHeader").find(".downVote").addClass("inactive").removeClass("active"),$(this).parent().parent().data("vote","1")):($(this).parent().parent().removeClass("upVoted"),$(this).removeClass("inactive"),$(this).parent().parent().addClass("downVoted"),$(this).addClass("active"),$(this).closest(".requestHeader").find(".upVote").addClass("inactive").removeClass("active"),$(this).parent().parent().data("vote","-1")),$(this).parent().parent().removeClass("selectedRequest"))});$(".removeRequest").click(function(){$(this).parent().parent().removeClass("upVoted");$(this).parent().parent().removeClass("downVoted");$(this).parent().children(".requestText").text("");$(this).parent().parent().hasClass("selectedRequest")&&(curRequest="");$(".request").removeClass("selectedRequest")});$(document).on("click",".songLinkA",function(n){(n.preventDefault(),$(this).hasClass("disabled"))||(setMessage(""),selected($(this).data("songid"))?setMessage("One request per song per 24-hour period."):addRequest(art,$(this).data("songid"),$(this).data("text")))});sdta.length==0&&(parent.showContent("#otherCharm","gmrnodata.html",!0),disableRequests=!0);$("#requestWrapper").show();songList=$("#SongList").DataTable({aaData:sdta,orderClasses:!0,sDom:"f<'toolbar'>t",paging:!1,responsive:!0,bAutoWidth:!0,fixedHeader:!0,sScrollX:"100%",sScrollY:"300px",bScrollAutoCss:!1,oLanguage:{sSearch:"",searchPlaceholder:"Start typing...",sEmptyTable:"There are no songs to show!"},columnDefs:[{orderable:!0,width:"33%",targets:0,render:function(n,t,i){return"<div class='songLinkA' data-text='"+escape(encodeURI(i.Title+": "+i.Artist))+"' data-songid='"+escape(i.ID)+"'>"+i.Title+"<\/div>"}},{orderable:!0,width:"33%",targets:1,render:function(n,t,i){return"<div class='songLinkA' data-text='"+escape(encodeURI(i.Title+": "+i.Artist))+"' data-songid='"+escape(i.ID)+"'>"+i.Artist+"<\/div>"}},{orderable:!0,width:"33%",targets:2,render:function(n,t,i){return"<div class='songLinkA' data-text='"+escape(encodeURI(i.Title+": "+i.Artist))+"' data-songid='"+escape(i.ID)+"'>"+i.Category+"<\/div>"}},]});$(".dataTables_filter input").attr("placeholder","Enter seach term here");$(".dataTables_filter input").css({"font-size":"16px",width:"170px","margin-right":"0","margin-bottom":"-20px"});$("div.toolbar").html('<button class="button small-button" id="submitButton"><span class="mif-checkmark"><\/span> Done!<\/button>').css({"margin-top":"0",width:"150px","margin-bottom":"-66px"});$(document).on("click","#submitButton",function(n){var r,t;if(n.stopPropagation(),counts=getCountFromIP(ipAddress,art.ArtistID+""),counts.Songs.length>=art.MaxiRequests&&$(this).addClass("disabled"),!$(this).hasClass("disabled")){var u=!1,f=!0,i=0;if($(".request").each(function(n,t){var e=$(t).find(".requestText")[0].innerText,r=1;!$(this).data("vote")&&art.EnableDownvotes?f=!1:r=$(this).data("vote");e.trim()!=""&&!$(t).hasClass("disabled")&&$(t).is(":visible")&&($(t).hide(),iRequestCreate(art.ArtistID,$(this).data("songid"),r,ipAddress),u=!0,i++)}),u||$("#Message").text("No new requests to send!"),f||$("#Message").text("You have made selections, but have not given the selections a vote."),r="",i>=art.MaxiRequests){for(t=0;t<=i;t++)$("#request"+t).show();$(".removeRequest").hide();$(".outerTableWrapper").hide();r+="Come back tomorrow to make more requests!"}$("#Message").text(art.ArtistName+" thanks you for using GigMan Request! "+r)}});adjustView(art)}});
/*
//# sourceMappingURL=gmrrequests.min.js.map
*/