"use strict";function adjustChrome(){var n=$("#lyricsHeader").height(),t;n<55&&(n=15);n>60&&(n-=35);t=document.createElement("style");t.type="text/css";t.innerHTML=".listOffset { margin-top: "+n+"px!important; } .tileOffset { margin-top:"+n+"px!important}";document.getElementsByTagName("head")[0].appendChild(t);$("#sTranspose").addClass("tileOffset");$("#lyricsDiv").addClass("listOffset");n=window.innerHeight-$("#lyricsHeader").height()-getScrollbarWidth()-1;$(".toolSliders").css("height",n);$("#sTranspose").css("height",n/2-5);$("#sChangeFontSize").css("height",n/2-5);$("#sChangeFontSize").css("top",-15)}function setFontSlider(n,t){$("#sChangeFontSize").find(".ui-slider-handle").text(n);t&&$("#sChangeFontSize").slider("value",n);setSession("lyricFontSize",n)}function setKeySlider(n,t){$("#sTranspose").find(".ui-slider-handle").text(keyList[n]);t&&$("#sTranspose").slider("value",n)}function adjustLyricsArea(){var n=getSession("lyricFont");setFontFaceSwitch(n);getSession("rightSliders")=="true"?$("#lyricsDiv").css("padding-left","40px"):$("#lyricsDiv").css("padding-left","5px");jss.set("#lyricsDiv",{"margin-top":$(".pageHeader").css("height")+"!important"});jss.set(".Verse",{color:getSession("verseColor")});jss.set(".AlternateVerse",{color:getSession("alternateVerseColor")});jss.set(".Bridge",{color:getSession("bridgeColor")});jss.set(".Chorus",{color:getSession("chorusColor")});jss.set(".Divider",{"background-color":getSession("dividerColor")});jss.set(".lyricsDiv",{"background-color":getSession("lyricBackgroundColor")},{"font-size":getSession("lyricFontSize")+" !important"},{"font-family":getSession("lyricFont")});jss.set(".LyricsWrapper",{"background-color":getSession("lyricBackgroundColor")+" !important"});jss.set(".LyricsBackground",{"background-color":getSession("lyricBackgroundColor")+" !important"});jss.set(".lyricsBlock",{"background-color":getSession("lyricBackgroundColor")},{"font-size":getSession("lyricFontSize")+" !important"},{"font-family":getSession("lyricFont")});jss.set(".embeddedChord",{"background-color":getSession("embeddedChordBackgroundColor")});jss.set(".chord",{color:getSession("chordColor")});jss.set(".LyricsBackground",{"background-color":getSession("lyricBackgroundColor")});jss.set("toolSliders",{"background-color":getSession("lyricBackgroundColor")})}function init(n){var t,i;n||(n=songByID(getQueryParameters(document.location.search).id,getActiveArtistID()));showChordHints=getSession("showChordHints")=="true"?!0:!1;showChords=getSession("showChords")=="true"?!0:!1;$("#ChordVisibility").prop("checked",showChords);$("#PopupChordHints").prop("checked",showChordHints);$("#PopupChordVisibility").prop("checked",showPopupChords);showChords?($("PopupChordVisibility").attr("disabled",!1),$("#PopupChordHints").attr("disabled",!1)):(showPopupChords=!1,showChordHints=!1,$("#PopupChordVisibility").attr("disabled",!0),$("#PopupChordHints").attr("disabled",!0),$("#PopupChordHints").attr("checked",!1));setKeySlider(n.key);setFontSlider(parseInt(getSession("lyricFontSize")));getSession("rightSliders")=="true"?$("#RightSliders").show():$("#RightSliders").hide();showChords=getSession("showChords");$("#lyricsDiv").css("font-family",getSession("lyricFont"));t=new Date(n.LastPlayed);t=t.getFullYear()<2e3?"n/a":pad(t.getFullYear())+"/"+pad(t.getMonth())+"/"+pad(t.getDay()+1);$("#SongInfo").html("<table class='songInfo'><tr><td colspan='2' style='text-align:center'>"+n.Title+"<br/><a class='artistLink' data-artist='"+n.Artist+"'>"+n.Artist+"<\/a><\/td><\/tr><tr><td>Key :&nbsp;<\/td><td>&nbsp;"+keyList[n.Key]+"<\/td><\/tr><tr><td>Last played :&nbsp;<\/td><td>&nbsp;"+t+"<\/td><\/tr><tr><td>Genre :&nbsp;<\/td><td>&nbsp;"+genreNameFromID(n.Genre)+"<\/td><\/tr><tr><td>Category :&nbsp;<\/td><td>&nbsp;"+n.Category+"<\/td><\/tr><tr><td>Familiarity :&nbsp;<\/td><td>&nbsp;"+familiarityNameFromID(n.Familiarity)+"<\/td><\/tr><tr><td>Tempo :&nbsp;<\/td><td>&nbsp;"+tempoNameFromID(n.Tempo)+"<\/td><\/tr><\/table>");$(".keyPad[data-key='"+n.Key+"']").addClass("selected");n.Notes!=""&&($("#NotesTitle").text("Notes - "+n.Title),$("#Notes").text(n.Notes));i=getSession("lyricFont");i=='"Courier New", Courier, monospace'?$("#Courier").prop("checked",!0):$("#Lucida").prop("checked",!0);n.Sample&&n.Sample!=""?($("#PlaySample").attr("href",n.Sample),$("#PlaySample").attr("target","_new")):$("#PlaySample").css("disabled",!0);adjustLyricsArea()}function getSegmentType(n){var t=n.split("\n")[0].trim().toLowerCase().replace(":","");switch(t){case"br":case"bridge":return"Bridge";case"ch":case"chorus":return"Chorus";default:return"Verse"}}function formatChords(n,t){return t=="AbovelineChords"?formatAbovelineChords(n):formatEmbeddedChords(n)}function formatEmbeddedChords(n){var r,u;n=n.replace(/&nbsp;/g," ");for(var i=n.split(" "),t=0,f="",t=0;t<i.length;t++)r="",i[t].indexOf("|")==0?(u=i[t].replace("|",""),r+="<chord class='chord embeddedChord' data-text='"+u.replace("&nbsp;","")+"' data-original-text='"+u.replace("&nbsp;","")+"' data-inlineChord='true'>"+u.replace("&nbsp;","")+"<\/chord> "):r=i[t]+"&nbsp;",f+=r;return f}function formatAbovelineChords(n){var t,u;n=n.substring(1);n=n.replace(/&nbsp;/g," ");for(var f=n.split(" "),r="",i=0,i=0;i<f.length;i++)t=f[i],u=t,t!=""&&t!=" "&&/^[a-gA-G]/.test(t)&&(u="<chord class='chord' data-text='"+t+"' data-original-text='"+t+"' data-inlineChord='false'>"+t+"<\/chord>"),i>0&&(r+="&nbsp;"),r+=u;return"<chordset>"+r+"<br/><\/chordset>"}function getLyrics(n){for(var t,s,e,c,r,i,o,f=n.Lyrics.replace(/\r\n/g,"\n").split("\n\n"),l=[],h=!1,u=0;u<f.length;u++){for(f[u][0]=="\n"&&(f[u]=f[u].substring(1)),t={},t.chordType="None",t.hintLineIndex=-1,t.Collapsed=!1,s=getSegmentType(f[u]),s=="Verse"&&(h&&(s="AlternateVerse"),h=!h),t.Type=s,t.lines=[],e=f[u].split("\n"),c=!1,r=0;r<e.length;r++)(e[r][0]=="-"&&(t.Collapsed=!0),i=e[r].trim(),i.toLowerCase()!="chorus"&&i.toLowerCase()!="ch"&&i.toLowerCase()!="br"&&i.toLowerCase()!="bridge"&&i.toLowerCase()!="v"&&i.toLowerCase()!="verse")&&(o={},i.indexOf("~")>-1||i.indexOf("|")>-1?(c=!0,hasChords=!0,o.isChords=!0,t.chordType=i.indexOf("|")>-1?"EmbeddedChords":"AbovelineChords",i=formatChords(i,t.chordType)):(c=!1,o.isChords=!1,i=i.replace(/ /g,"&nbsp;")),o.line=i,e.length>1&&(r==0&&t.chordType=="None"||t.chordType=="EmbeddedChords"||r==1&&t.chordType=="AbovelineChords")&&(t.hintLineIndex=r),t.lines.push(o));t.lines.length>0&&l.push(t)}return l}function renderLyrics(n){var s=document.getElementById("lyricsDiv"),o,t,i,f,r,e,u;for(s.innerHTML="",o=!1,t=0;t<n.length;t++){for(n[t].chordType=="EmbeddedChords"&&(o=!0),i=document.createElement("details"),isChrome()||(i=document.createElement("p")),i.id="lyrics"+t,i.className=n[t].Type+" lyricsBlock",n[t].lines.length<2&&(i.className+=" nosummary"),i.open=!n[t].Collapsed,n[t].lines.length>1&&(f=document.createElement("summary"),f.style.border="none",n[t].Collapsed&&(f.style.fontWeight="bold")),r=0;r<n[t].lines.length;r++)e=n[t].lines[r].line,n[t].lines[r].isChords&&n[t].chordType!="EmbeddedChords"||(e+="<br/>"),r<=n[t].hintLineIndex&&n[t].lines.length>1?(f.innerHTML+=e,i.appendChild(f)):i.innerHTML+=e;n[t].lines.length==1&&(i=document.createElement("p"),i.innerHTML=n[t].lines[0].line,i.className+="Verse lyricsBlock nosummary");document.getElementById("lyricsDiv").appendChild(i);document.getElementById("lyricsDiv").appendChild(document.createElement("br"));useDividers&&t+1<n.length&&(u=document.createElement("hr"),u.style.height=dividerSize+"px",u.style.border="none",u.style.backgroundColor=dividerColor,u.className="Divider",document.getElementById("lyricsDiv").appendChild(u))}$("chord").each(function(){var n=$(this).data("text");superscriptChords&&(n=superscript(n),o&&(n+="&nbsp;"));$(this).html(n,!0)});modifyStyles()}function superscript(n,t){var i=1;return n=n.replace("&nbsp;"," "),i<n.length&&(n=n.substring(0,i)+"<sup>"+n.substring(i)+"<\/sup>"),n.indexOf("|")==-1&&(t||(n=n.replace("<\/chord>",""))),n.replace(" ","&nbsp;")}function transposeChords(n){var i=song.Key,r=n-i,t=$("#spc").width()/2;$("chord").each(function(){var u=$(this).data("original-text"),e=1,f,n,o,i;(u.indexOf("b")>-1||u.indexOf("#")>-1)&&(e=2);f=u.substring(0,e);n=keyList.indexOf(f)+r;n<0&&(n=12+n);n>11&&(n=n-12);o=keyList[n];i=u.replace(f,o);i=="A#"&&(i="Bb");$(this).data("text",i);$(this).data("inlinechord")==!0&&(i+="&nbsp;");superscriptChords&&(i=superscript(i));$(this).data("inlinechord")==!1&&($(this).data("text").length>$(this).data("original-text").length?$(this).css("margin-left",-t):$(this).data("text").length<$(this).data("original-text").length&&$(this).css("margin-left",t));$(this).html(i)})}function keyIndex(n){for(var t=0;t<keyList.length;t++)if(keyList[t]==n)return t;return-1}function transpose(n){initialized&&transposeChords(n)}function changeFontSize(n){initialized&&(setSession("lyricFontSize",n+"px"),$(".lyricsDiv").css("font-size",n+"px"))}var hasChords=!1,segments=[],keyList=["A","Bb","B","C","C#","D","Eb","E","F","F#","G","Ab"],showChords,showPopupChords,superscriptChords,showChordHints,song,useDividers=!0,dividerSize=2,dividerColor,initialized=!1,notesChanged=!1;$(document).ready(function(){var t,n,i,r,u;$("#FontSize").val(parseInt(getSession("lyricFontSize")+"px"));$("#sTranspose").slider({range:"min",max:11,min:0,animate:"fast",orientation:"vertical",change:function(){var n=$("#sTranspose").slider("option","value");setKeySlider(n);transpose(n)},slide:function(){var n=$("#sTranspose").slider("option","value");setKeySlider(n);transpose(n)}});$("#sChangeFontSize").slider({range:"min",max:28,min:12,animate:"fast",orientation:"vertical",change:function(){var n=$("#sChangeFontSize").slider("option","value");setFontSlider(n);$("#lyricsDiv").css({"font-size":n+"px"})},slide:function(){var n=$("#sChangeFontSize").slider("option","value");setFontSlider(n);$("#lyricsDiv").css({"font-size":n+"px"})}});checkLoginStatus()||(window.location.href="default.html");showChords=getSession("showChords")=="true";showPopupChords=getSession("showPopupChords")=="true";superscriptChords=getSession("superscriptChords")=="true";showChordHints=getSession("showChordHints")=="true";t=getSession("colorscheme");t=="highcontrast"&&$("#colorScheme").prop("checked",!0);adjustLyricsArea();$(document).click(function(n){n.target.parentElement.className!="songInfo"&&$("#SongInfo").is(":visible")&&($("#SongInfo").hide(),n.preventDefault())});$("#Notes").bind("input propertychange",function(){notesChanged=!0});$("#closeNotesPanel").on("click",function(){$("#notesPanel").hide();notesChanged&&(song.Notes=$("#Notes").val(),songSave(song))});$("chord").on("click",function(n){showChordHints&&n.preventDefault()});$(".keyPad").click(function(){var n="";n=$(this).data("key");$(".keyPad").removeClass("selected");$(this).addClass("selected");transposeChords($(this).data("key"))});$(document).on("click",".lyricsBlock",function(){$(this)[0].open?$(this)[0].removeAttribute("open"):$(this)[0].open=!0});$(document).on("click","summary",function(){$(this)[0].parentNode.open?$(this)[0].parentNode.removeAttribute("open"):$(this)[0].parentNode.open=!0});$("#ChordVisibility").click(function(){showChords=this.checked;setSession("showChords",showChords);showChords?$("chordset").show():$("chordset").hide()});$("#PopupChordHints").click(function(){setSession("showChordHints",this.checked);showChordHints=this.checked});$("#PopupChordVisibility").click(function(){showPopupChords=!showChordHints;showPopupChords?($("chord").addClass("clickableChord"),$("#PopupChordHints").prop("disabled",!1)):($("chord").removeClass("clickableChord"),$("#PopupChordHints").prop("checked",!1),$("#PopupChordHints").prop("disabled",!1),showChordHints=!1);setSession("showPopupChords",showPopupChords)});$(".notesButton").click(function(){$("#notesPanel").draggable();$("#notesPanel").is(":visible")?($("#notesPanel").hide(),notesChanged&&(song.Notes=$("#Notes").val(),songSave(song))):$("#notesPanel").show()});$(".songInfo").click(function(n){n.preventDefault();$("#SongInfo").draggable();$("#SongInfo").is(":visible")?$("#SongInfo").hide():$("#SongInfo").show()});$("#RightSliderVisibility").click(function(){setSession("rightSliders",this.checked);this.checked?$("#RightSliders").show():$("#RightSliders").hide();adjustLyricsArea()});$("#IncPlayCount").click(function(){incrementSongCount(n.a,n.t)});n=getQueryParameters(document.location.search);$("#FontSize").on("input",function(n,t){sliderChange(n,t)});$("#collapseHeader").click(function(){parseInt($("#lyricsHeader").css("height"))<55?$("#lyricsHeader").css("height",55):$("#lyricsHeader").css("height",20);adjustChrome()});n.id!=null&&(song=songByID(n.id,getActiveArtistID()),song.SongID=parseInt(song.SongID),song.Key=parseInt(song.Key),$("#sTranspose").css("height",(window.innerHeight-50)/2),$("#sChangeFontSize").css("height",(window.innerHeight-100)/2),$("#FontSize").val(parseInt(getSession("lyricFontSize"))),setFontSlider(parseInt(getSession("lyricFontSize")),!0),$(".lyricsDiv").css("font-size",getSession("lyricFontSize")),$("#lyricsDiv").css("font-size",getSession("lyricFontSize")),setKeySlider(song.Key,!0),init(song),initialized=!0,segments=getLyrics(song),renderLyrics(segments),i=window.navigator.userAgent,r=i.indexOf("MSIE "),(r>0||!!navigator.userAgent.match(/Trident.*rv\:11\./))&&$("#toolsCharm").width($("#toolsCharm").width()+50),showChordHints?$("chord").addClass("clickableChord"):$("chord").removeClass("clickableChord"));u=song==null?0:song.Key;$("#DataList").css("margin-top",$("#lyricsHeader").css("height"));adjustChrome()});
/*
//# sourceMappingURL=lyrics.min.js.map
*/